http:
  routers:
    # Router untuk Jenkins (akses via IP)
    jenkins:
      rule: "PathPrefix(`/jenkins`)"
      service: jenkins-service
      middlewares:
        - jenkins-headers

    # Router untuk project lainnya
    project1:
      rule: "PathPrefix(`/project1`)"
      service: project1-service
      middlewares:
        - project1-stripprefix

    project2:
      rule: "PathPrefix(`/project2`)"
      service: project2-service
      middlewares:
        - project2-stripprefix

  middlewares:
    jenkins-headers:
      headers:
        customRequestHeaders:
          X-Forwarded-Proto: "http"
          X-Forwarded-Port: "58002"
        
    project1-stripprefix:
      stripPrefix:
        prefixes:
          - "/project1"

    project2-stripprefix:
      stripPrefix:
        prefixes:
          - "/project2"

  services:
    jenkins-service:
      loadBalancer:
        servers:
          - url: "http://jenkins:8080"

    project1-service:
      loadBalancer:
        servers:
          - url: "http://project1-app:3000"

    project2-service:
      loadBalancer:
        servers:
          - url: "http://project2-app:8000"